import{x as V,r as L,d as j,W as B,w as M,c as o,o as r,a as p,u as m,g as N,e as v,b as t,f as y,v as R,F as i,h as _,t as l,i as k,j as g,k as T,l as D,S as U,n as E}from"./app-a8NxV_Wl.js";import{_ as F}from"./AuthenticatedLayout-BXOZ2c7L.js";import{P as H}from"./PrimaryButton-C1J-uQhX.js";import{l as I}from"./lodash-CiE3EFiP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"max-w-6xl px-4 py-8 mx-auto"},P={class:"flex flex-col items-center gap-4 mb-4 md:flex-row"},W=["value"],$={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},z={class:"p-4 bg-white rounded shadow dark:bg-gray-800"},q={class:"divide-y dark:divide-gray-600 max-h-[600px] overflow-y-auto"},G=["onClick"],J={class:"flex items-center justify-between"},K={class:"text-xs text-gray-400"},Q={class:"text-xs text-right text-gray-500 dark:text-gray-300"},X={key:1,class:"text-red-500"},Y={class:"mt-4 overflow-x-auto"},Z={class:"flex flex-wrap justify-center gap-2"},ee={class:"p-4 bg-white rounded shadow dark:bg-gray-800"},te={key:0},se={class:"mb-2 text-gray-800 dark:text-gray-100"},re=["value"],oe={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},ce={__name:"Index",props:{students:Object,rooms:Array,classLevels:Array,filters:Object},setup(w){const d=w,a=V({user_id:"",room_id:""}),n=L({search:d.filters.search||"",class_level_id:d.filters.class_level_id||""}),u=j(null),S=x=>{u.value=x,a.user_id=x.id,a.room_id=""},A=()=>{if(!a.user_id||!a.room_id){alert("กรุณาเลือกนักเรียนและห้องเรียน");return}a.post(route("assign-room.assign"),{preserveScroll:!0,onSuccess:()=>{u.value=null,a.reset()}})},C=I.debounce(()=>{B.get(route("assign-room.index"),n,{preserveState:!0,preserveScroll:!0,replace:!0})},400);return M(()=>({...n}),()=>{C()},{deep:!0}),(x,s)=>(r(),o(i,null,[p(m(N),{title:"Assign Room to Students"}),p(F,null,{header:v(()=>s[3]||(s[3]=[t("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-200"}," Assign Room to Students ",-1)])),default:v(()=>[t("div",O,[t("div",P,[y(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.search=e),placeholder:"Search by name or student ID",class:"w-full p-2 border rounded md:w-1/2 dark:bg-gray-700 dark:text-white"},null,512),[[R,n.search]]),y(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.class_level_id=e),class:"w-full p-2 border rounded md:w-1/4 dark:bg-gray-700 dark:text-white"},[s[4]||(s[4]=t("option",{value:""},"All Class Levels",-1)),(r(!0),o(i,null,_(d.classLevels,e=>(r(),o("option",{key:e.id,value:e.id},l(e.name_th),9,W))),128))],512),[[k,n.class_level_id]])]),t("div",$,[t("div",z,[s[5]||(s[5]=t("h3",{class:"mb-2 font-semibold text-gray-700 dark:text-gray-200"},"Students",-1)),t("ul",q,[(r(!0),o(i,null,_(d.students.data,e=>{var c,h,f,b;return r(),o("li",{key:e.id,class:"px-2 py-2 rounded cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:ae=>S(e)},[t("div",J,[t("div",null,[g(l(e.name_th+" "+e.surname_th||e.name_en+" "+e.surname_en)+" ",1),t("span",K,"("+l(e.student_id)+")",1)]),t("div",Q,[((c=e.current_room)==null?void 0:c.length)>0?(r(),o(i,{key:0},[g(l((f=(h=e.current_room[0])==null?void 0:h.class_level)==null?void 0:f.name_th)+" "+l((b=e.current_room[0])==null?void 0:b.name_room_th),1)],64)):(r(),o("span",X,"ยังไม่กำหนดห้อง"))])])],8,G)}),128))]),t("div",Y,[t("div",Z,[d.students.links?(r(!0),o(i,{key:0},_(d.students.links,e=>(r(),D(m(U),{key:e.label,href:e.url||"#",class:E(["px-3 py-1 text-sm border rounded min-w-[40px] text-center",{"bg-blue-500 text-white":e.active,"text-gray-700 dark:text-gray-300":!e.active,"cursor-not-allowed":!e.url}]),innerHTML:e.label},null,8,["href","class","innerHTML"]))),128)):T("",!0)])])]),t("div",ee,[s[9]||(s[9]=t("h3",{class:"mb-2 font-semibold text-gray-700 dark:text-gray-200"},"Assign Room",-1)),u.value?(r(),o("div",te,[t("p",se,[s[6]||(s[6]=g(" Assign room to: ")),t("strong",null,l(u.value.name_th||u.value.name_en),1)]),y(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>m(a).room_id=e),class:"w-full p-2 border rounded dark:bg-gray-700 dark:text-white"},[s[7]||(s[7]=t("option",{value:""},"เลือกห้อง",-1)),(r(!0),o(i,null,_(d.rooms,e=>{var c;return r(),o("option",{key:e.id,value:e.id},l((c=e.class_level)==null?void 0:c.name_th)+" - "+l(e.name_room_th),9,re)}),128))],512),[[k,m(a).room_id]]),p(H,{class:"mt-4",onClick:A},{default:v(()=>s[8]||(s[8]=[g(" Assign ")])),_:1})])):(r(),o("p",oe,"เลือกนักเรียนจากฝั่งซ้ายก่อน"))])])])]),_:1})],64))}};export{ce as default};
